<!DOCTYPE html>
<script src='./sources/three.js'></script>
<script src='./sources/threex.dynamictexture.js'></script>
<html>
  <head>
     <script src="./sources/d3.min.js"></script>
  </head>

	<body></body>
  
  <script>
    d3.json("sources/newsapi.json").then(function (data) {

    let text = data.article[tweetID = 2].tweet;
    console.log('🐦 tweet: ' + text);

      function createLabel(text, fontsize, fontColor) {
          let canvas = document.createElement('canvas');
          let ctx = canvas.getContext('2d');
          canvas.style.border = "1px solid black";

          canvas.width  = 200;
          canvas.height = 600;  
          document.body.appendChild(canvas);  

          var max_width = canvas.width-10;
          var fontSize = 12;
          var lines = new Array();
          var width = 0, i, j;
          var result;
          var color = fontColor || "white";

          //ctx.lineWidth = "1000";
          ctx.strokeStyle = "red";
          ctx.moveTo(0, 400);
          ctx.lineTo(200, 400);
          ctx.stroke();

          ctx.font = fontSize + "Arial";

          while ( text.length ) {
            for( i=text.length; ctx.measureText(text.substr(0,i)).width > max_width; i-- );
          
            result = text.substr(0,i);
          
            if ( i !== text.length )
              for( j=0; result.indexOf(" ",j) !== -1; j=result.indexOf(" ",j)+35 );
            
            lines.push( result.substr(0, j|| result.length) );
            width = Math.max( width, ctx.measureText(lines[ lines.length-1 ]).width );
            text  = text.substr( lines[ lines.length-1 ].length, text.length );
          }

          //ctx.canvas.width = 14 + width;
          //ctx.canvas.height = 8 + (fontSize + 5) * lines.length;
          ctx.font   = fontSize + "Arial";

          // Render
          ctx.fillStyle = color;
          for ( i=0, j=lines.length; i<j; ++i ) {
            ctx.fillText( lines[i], 8, 450 + fontSize + (fontSize+5) * i );
          }
      }

      createLabel(text, 12, "red");
})
    </script>
</html>